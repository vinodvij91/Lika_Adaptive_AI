# Lika Sciences Platform

## Overview
Lika Sciences is a scientific SaaS platform for drug discovery and molecular research, focusing on managing molecule registries, research campaigns, and SMILES data. It aims to streamline drug discovery workflows, accelerate molecular research, and enable data-driven decisions in scientific R&D through clear information, robust data visualization, and professional scientific presentation, with future extensibility for advanced chemistry computations.

## User Preferences
Preferred communication style: Simple, everyday language.

## System Architecture
The platform utilizes a full-stack TypeScript architecture with React, Vite, shadcn/ui, and Tailwind CSS for the frontend, using TanStack React Query for state management. The backend is built with Node.js, Express, TypeScript, and PostgreSQL, employing Drizzle ORM and drizzle-zod for database interactions and schema validation. Shared schemas and types are managed in a `shared/` directory.

### Key Domain Features
- **Molecule & Project Management**: Manages chemical compounds (SMILES notation) and organizes them into projects and research campaigns with various modalities (small molecule, PROTAC, peptide, fragment).
- **Data Import & Curation**: Supports batch import of SMILES with validation, duplicate detection, and provides curated domain-aware SMILES libraries.
- **Scientific Terminology**: Integrates professional drug discovery terminology across the platform.
- **Compute Nodes**: Manages multi-provider infrastructure (Hetzner, Vast.ai, AWS, Azure, GCP, On-Prem) for ML, docking, quantum, and agent workloads, including SSH key management and usage tracking.
- **Advanced Scientific Modules**: Includes Multi-Target SAR for profiling and visualization, Translational Medicine for target variants and extended molecule scoring, Wet-Lab Integration for assay definition and experiment recommendations, and Literature & IP for annotations and risk screening.
- **Collaboration & Templates**: Supports multi-organization collaboration with role-based access and provides disease-specific pipeline templates.
- **Materials Science**: A first-class domain supporting polymers, crystals, composites, catalysts, membranes, and coatings with both structure-first and property-first discovery modes.

### Materials Science Data Model
Core tables include `material_entities` for material identity and representation, `material_variants` for structural exploration, `material_properties` for predictions, `materials_programs` for high-level research, `materials_campaigns` for discovery, and `materials_oracle_scores` for scoring.

### Internal Normalized Schemas
The Import Hub converts diverse industry formats into canonical tables, performing deduplication and normalization for both drug discovery (e.g., `canonical_molecules`, `molecule_descriptors`, `canonical_assays`) and materials science (e.g., `canonical_materials`, `canonical_material_properties`).

### Asset Storage Strategy
DigitalOcean Spaces (S3-compatible) is used for primary storage of assets generated by compute nodes, with metadata stored in a `compound_assets` PostgreSQL table. Assets are served via CDN.

### Enterprise-Scale Processing Infrastructure
Designed for industrial-scale materials discovery, the platform features a robust processing jobs system (`processing_jobs` table) for orchestration, status tracking, and fault tolerance. It includes `processing_job_runs` for retry management, `processing_job_events` for streaming results, and `job_artifacts` for storing computation outputs, with an artifact ingestion system to process Python computation results. Precomputed aggregations (`materials_campaign_aggregates`, `material_variant_metrics`) provide dashboard data and per-variant metrics.

### API Design
The platform uses RESTful API endpoints under `/api/`, with specific `/api/agent/` endpoints tailored for AI interaction and service account roles defining agent permissions.

### Design System
Adheres to Material Design principles with Carbon Design data patterns, utilizing Inter and JetBrains Mono fonts, and a custom Tailwind theme for scientific visualization and data-dense layouts.

### Quantum Compute Integration
The architecture is designed to integrate with quantum computation services for future optimization and scoring.

### Python Compute Pipeline Integration
The platform includes a production-grade Python pipeline (`compute/drug_discovery_pipeline.py`) for executing computational chemistry workloads:

**Features:**
- Dask distributed computing for parallel processing
- RAPIDS cuML for GPU-accelerated machine learning (10-50x speedup)
- PyTorch mixed precision training (2x GPU speedup)
- AutoDock Vina integration for molecular docking
- XGBoost with GPU acceleration

**Compute Infrastructure:**
- **CPU Jobs (Hetzner)**: SMILES validation, fingerprint generation, property calculation, rule filtering
- **GPU Jobs (Vast.ai with 2x RTX 3090)**: ML prediction, neural network inference, Vina docking

**CLI Interface:**
```bash
python3 drug_discovery_pipeline.py --job-type <step_name> --params '{"smiles": [...], "targetId": "..."}'
```

**Supported Steps:**
- `smiles_validation` - Validate SMILES strings
- `fingerprint_generation` - Generate Morgan fingerprints
- `property_calculation` - Calculate molecular properties (MW, LogP, TPSA, etc.)
- `ml_prediction` - Run ML predictions on molecules
- `vina_docking` - Molecular docking with AutoDock Vina
- `scoring` - Calculate oracle scores
- `rule_filtering` - Apply Lipinski/Veber rules

**Required Environment Variables:**
- `HETZNER_SSH_HOST`, `HETZNER_SSH_USER`, `HETZNER_SSH_PORT` - For Hetzner CPU nodes
- `VAST_AI_API_KEY` - For Vast.ai GPU nodes
- `SSH_PRIVATE_KEY` - SSH key for remote node access

**API Endpoints:**
- `GET /api/compute/health` - Check node health
- `GET /api/compute/capacity` - Get available CPU/GPU capacity
- `POST /api/compute/execute` - Execute a pipeline job (async by default)
- `POST /api/compute/pipeline` - Run full pipeline on campaign
- `POST /api/compute/setup` - Auto-configure nodes from env vars

## External Dependencies
- **PostgreSQL**: Primary relational database.
- **Radix UI primitives**: For building UI components.
- **cmdk**: For command palette functionality.
- **embla-carousel-react**: For carousel components.
- **date-fns**: For date utility functions.